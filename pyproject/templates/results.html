{% extends 'layout.html' %}
{% block content %}
<hr>
<div class="wrapper cont">
<h3 align="center"><superscript>Pageinsights Analysis</superscript></h3>
<subscript>{{analyzedurl}}</subscript>
<hr>
    
<hr>
<!--  performance summary-->
<div align="center"> <h5 align="center">Areas to be improved</h5>
    {% for key,value in auditsdata.items() %}
        {% if value["score"] is not none %} 
            {% if value["score"]*100 < 99 and value["score"]*100 > 1 %}
                <!-- if performance is bad then yellow -->
                {% if value["score"]*100 < 75 and value["score"]*100 > 1 %}
                <a href="#{{key}}"><strong>{{key}}</a>   <div style="color:rgb(255, 115, 0);">{{value["score"]*100}}%</div></strong><br>
                <!-- else performance is average -->
                {% else %}
                <a href="#{{key}}"><strong>{{key}}</a> <div style="color:rgb(0, 38, 255);">{{value["score"]*100}}%</div></strong><br>
                {%endif %}
            {%endif %}
        {%endif %}
    {% endfor %}
</div>
<hr>
<div align="center" class="baseinfocont">
    <!-- base information about the current page -->
    <h5 align="center">BASE INFORMATION</h5> 
    <caption>{{analyzedurl}}</caption>
    <br>
    Captcha status :  {{captcha}}
    <br>
    <small>Timestamp      :  {{timestamp}}</small>
    <br>
</div>
<hr>
<div align="center" class="lighthouseResultcont">
    <!-- url redirections information -->
    <h5>URL INFO</h5> 
    Initial Url :&nbsp&nbsp&nbsp&nbsp<a href="{{lighthouseResult["requestedUrl"]}}">{{lighthouseResult["requestedUrl"]}}</a>
    <br>
    Final Url :&nbsp&nbsp&nbsp&nbsp<a href="{{lighthouseResult["finalUrl"]}}">{{lighthouseResult["finalUrl"]}}</a>
    <hr>
    <br>    
</div>
<div align="center" class="previewcont">
    <!-- usage of iframe in preview of the analyzed site  -->
    <h5 align="center">Preview (Available only for selected sites)</h5> 
    <iframe src="{{lighthouseResult["finalUrl"]}}" width="100%" height="300" title="preview">
    </iframe>
</div>
<hr>
<!-- iterating through different attributes of metrics in auditsdata -->
<div id="datasets">
        <!-- performance calculation in selected attributes -->
        {% for key,value in auditsdata.items() %}
            <div id="{{key}}" class="attributes">
                <h5 align="center">{{key}} Analysis<br><br> 
                    {% if value["score"] is not none %}   
                        <small><strong>Performance :  {{value["score"]*100}}%</strong></small> 
                    {%endif %}   
            </h5> 
            <br>
            <!-- Display screenshots of the analyzed page -->
            {% if value['title']=="Full-page screenshot" : %}
                <div><img src="{{value["details"]["screenshot"]["data"]}}"" width="50%" height="300"></div>
            {% endif %}

            <!-- Display screenshots of the Final page -->
            {% if value['title']=="Final Screenshot" : %}
                <div><img src="{{value["details"]["data"]}}"" width="50%" height="300"></div>
            {% endif %}

            <!-- Display snapshots -->
            {% if value['title']=="Screenshot Thumbnails" : %}
                <div>
                    <img src="{{value["details"]["items"][2]["data"]}}"" width="10%" height="100">
                    <img src="{{value["details"]["items"][3]["data"]}}"" width="10%" height="100">
                    <img src="{{value["details"]["items"][4]["data"]}}"" width="10%" height="100">  
                    <br>  
                </div>
            {% endif %}
            
            <!-- Display title and description and remarks of the attributes -->
            <h6 align="center">&nbsp&nbsp&nbsp&nbsp {{value["title"]}}</h6>
            <br>
            <div align="left">Description :&nbsp&nbsp&nbsp&nbsp {{value["description"]}}</div>
            <br>
            <hr>
            </div>
        {% endfor %}
</div>

{% endblock content %}
